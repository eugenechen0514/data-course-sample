# 實作「rule-based」的推薦系統

# 目地
這專案是截取 2014 年 Amazon 發布的「美妝（All Beauty）」資料集，包含了
* 評論資訊 (評價星級、文字評價、投票等)
* 商品後設資料 (商品描述、類別、價格、品牌、圖片資訊等)

本專案希望可以實作「rule-based」的推薦算法，找使用者可能會購買的商品。

推薦分數是採用 Recall 的評估機制，也就是檢查「使用者真正會購買的商品中」，有哪些會出現在「推薦給使用者的商品中裡」。

以混淆矩陣(Confusion Matrix) 來說：
```
FP  |  TP
FN  |  TN
```

```
使用者沒有買，在推薦的商品        |  使用者真的有買的，推薦的商品中
使用者真的有買的，不在推薦的商品中  |  使用者沒有買，不在推薦的商品中
```

我們計算

```
recall = (使用者真的有買的，推薦的商品中) / (使用者真的有買的，推薦的商品中 + 使用者真的有買的，不在推薦的商品中)
```

# 想法策略

因為美妝是屬於個人用品的，所以我認為 "品牌黏著度" 是一個可以切入方向。

我們會拿使用者過去的購買紀錄，加以分析他們的"各品牌購買頻次"，然後計算出頻次的標準差。

若標準差越小表示，表示使用者越會黏著於同一品牌，可以試圖推薦同一品牌；反之，標準差越大，使用者越容易變心，可以試圖推不同的品牌給使用者。

```
同品牌的頃向 = 購買品牌頻次的標準差
```
> 注：一個人的頻次會先做標準化，如：A 買了兩個品牌 [2, 2]，會標準化成 [0.5, 0.5] 

因此，我們會先分析出使用者的 "同品牌的頃向"，找出適合的 threshold 來區分成：
1. `標準差 < threshold` 的人，隨機選出同品牌的商品
2. `標準差 >= threshold` 的人，隨機選出不同品牌的商品，除了已買過的品牌

若推薦後的量不足，就會從使用者過去曾買過的商品，隨機選出。

# 結果

算出的品牌頻次的標準差，如下：

`[min,max]: [0.0,0.42307692307692313]`

| 區間                                         | 人數     |
|---------------------------------------------|--------|
| [0.0 , 0.04230769230769231)                 | 314246 |
| [0.04230769230769231 , 0.08461538461538462) | 710    |
| [0.08461538461538462 , 0.12692307692307692) | 1155   |
| [0.12692307692307692 , 0.16923076923076924) | 2219   |
| [0.16923076923076924 , 0.21153846153846156) | 76     |
| [0.21153846153846156 , 0.25384615384615383) | 297    |
| [0.25384615384615383 , 0.29615384615384616) | 8      |
| [0.29615384615384616 , 0.3384615384615385)  | 63     |
| [0.3384615384615385 , 0.3807692307692308)   | 9      |
| [0.3807692307692308 , 0.42307692307692313)  | 1      |
| [0.42307692307692313 , 0.4653846153846154)  | 2      |

若去看品牌數量，會發現只有 4% 的人有兩個品牌以上。
因此可以預期若單純用到"品牌統計結果"的策略，可能會影響到的人數會很少。

```
#(品牌數=1): 302890 人
#(品牌數>1): 15896人

(品牌數>1) 的佔比: 4.986417220329631 %
```

因為"品牌統計結果"的策略可以，影響到的人數太少，所以很可能會回到基本的推薦方法：從買過的清單隨機挑選。

Recall 出算的結果有：0.011864406779661017, 0.015254237288135594, ...

總結來說，單單使用"品牌統計結果"的策略，可能不是很好的結果，因為最後還是會回到"從買過的清單隨機挑選"。
未來應該要更進一步的分析個人使用者習性或是使用全局特性(像是熱門商品/高評分商品…等)，來強化算法對於商品清單的過濾。